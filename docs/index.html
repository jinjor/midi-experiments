<!DOCTYPE HTML>
<html>
<head>
  <meta charset="UTF-8">
  <title>Main</title>
  <style>html,head,body { padding:0; margin:0; }
    body { font-family: calibri, helvetica, arial, sans-serif; }
  </style>
  <script src="index.js"></script>
</head>
<body>
  <script>
    let app = Elm.Main.fullscreen();
    app.ports.send.subscribe(data => {
      let output = outputs[data.portId];
      if(output) {
        output.send(data.message);
      }
    });
    let outputs = {};
    navigator.requestMIDIAccess()
      .then(midiAccess => {
        for(let output of midiAccess.outputs.values()) {
          outputs[output.id] = output;
        };
        app.ports.receiveMidiOuts.send(Object.keys(outputs).map(id => {
          let output = outputs[id];
          return {
            id: output.id,
            name: output.name
          };
        }));
      }).catch(e => {
        console.log(e);
      });
  </script>
</body>
